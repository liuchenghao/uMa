{"version":3,"sources":["uni-app:///main.js","webpack:////Users/liu/Documents/HBuilderProjects/uMa/pages/starting/index.vue?fbe8","webpack:////Users/liu/Documents/HBuilderProjects/uMa/pages/starting/index.vue?a74a","webpack:////Users/liu/Documents/HBuilderProjects/uMa/pages/starting/index.vue?ee6d","webpack:////Users/liu/Documents/HBuilderProjects/uMa/pages/starting/index.vue?76ca","uni-app:///pages/starting/index.vue","webpack:////Users/liu/Documents/HBuilderProjects/uMa/pages/starting/index.vue?4648","webpack:////Users/liu/Documents/HBuilderProjects/uMa/pages/starting/index.vue?0f7d"],"names":["createPage","Page"],"mappings":"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","file":"pages/starting/index.js","sourcesContent":["import 'uni-pages';\nimport Vue from 'vue'\nimport Page from './pages/starting/index.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./index.vue?vue&type=template&id=dc547508&scoped=true&\"\nvar renderjs\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=dc547508&lang=less&scoped=true&rel=stylesheet%2Fless&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"dc547508\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/starting/index.vue\"\nexport default component.exports","export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=template&id=dc547508&scoped=true&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"","<template>\n  <div class=\"starting-page\">\n    <div class=\"search-bar-wrapper\">\n      <search-bar ref=\"searchBar\"\n                  :curCity=\"curCity\"\n                  @chooseCity=\"chooseCity\"\n                  @cancel=\"cancel\"></search-bar>\n    </div>\n    <!--<div class=\"address-list-wrapper\" v-if=\"addresses.length\">-->\n    <!--<address-list :data=\"addresses\" @choose=\"chooseItem\"></address-list>-->\n    <!--</div>-->\n    <map class=\"map-didi\"\n         id=\"map-didi\"\n         :latitude=\"latitude\"\n         :longitude=\"longitude\"\n         :markers=\"markers\"\n         @regionchange=\"regionChange\"\n         @begin=\"begin\"\n         @end=\"end\"\n         show-location\n    >\n\n      <cover-image class=\"location-marker\"\n                   src=\"/static/img/location.png\"\n                   @click.stop=\"onclickLocation\">\n      </cover-image>\n\n      <cover-view class=\"center-marker\">\n        <cover-view class=\"text-center\">最快{{minutes}}分钟接驾</cover-view>\n        <cover-image class=\"inverted-triangle\" src=\"/static/img/triangle-down.png\"></cover-image>\n        <cover-image class=\"img-center\" src=\"/static/img/marker2.png\"></cover-image>\n      </cover-view>\n\n      <cover-view class=\"address\">\n        <cover-image class=\"img-address\" src=\"/static/img/address.png\">\n        </cover-image>\n        <cover-view class=\"address-desc\">\n          <cover-view class=\"blur\">{{startPlace}}</cover-view>\n          <cover-view class=\"detail\">{{startFormattedPlace}}</cover-view>\n        </cover-view>\n        <cover-view class=\"btn-address\" @click.stop=\"setStartPlace\">确定</cover-view>\n      </cover-view>\n    </map>\n  </div>\n</template>\n\n<script type=\"text/ecmascript-6\">\n  import AddressList from '../../components/addressList.vue'\n  import SearchBar from '../../components/search-bar.vue'\n  import {QQ_MAP_key} from '../../common/constant/constant'\n  import QQMapWX from '../../common/lib/qqmap-wx-jssdk.js'\n  import {reverseGeocoder, getRandomNum} from '../../utils/index'\n  import {mapMutations, mapState} from 'vuex'\n\n  const qqmapsdk = new QQMapWX({\n    key: QQ_MAP_key\n  });\n\n  let touchTimeStamp = 0\n\n  export default{\n    data(){\n      return {\n        latitude: 0,\n        longitude: 0,\n        scale: 16,\n        markers: [],\n        addresses: [],\n        minutes: getRandomNum(3, 12)\n      }\n    },\n    onShow(){\n//     保证后面可以拿到经纬度\n      this.initLocation()\n      this.mapCtx = wx.createMapContext(\"map-didi\"); // 地图组件的id\n      console.log('this.curNavIndex', this.curNavIndex)\n      this.updateCars()\n    },\n    onUnload(){\n      this.clearData()\n    },\n    methods: {\n      initLocation(){\n        if (this.startPosition.length) {\n          this.latitude = this.startPosition[0]\n          this.longitude = this.startPosition[1]\n        } else {\n          wx.getLocation({\n            type: \"gcj02\",\n            success: (res) => {\n              this.longitude = res.longitude\n              this.latitude = res.latitude\n            }\n          })\n        }\n      },\n      chooseCity(){\n        wx.navigateTo({\n          url: '/pages/cityChoose/index'\n        })\n      },\n      search(value){\n        if (value.length === 0) {\n          this.addresses = []\n          return\n        }\n        qqmapsdk.getSuggestion({\n          keyword: value,\n          region: this.curCity,\n          success: (res) => {\n            this.addresses = res.data\n          }\n        })\n      },\n      chooseItem(item){\n        console.log(item)\n        this.latitude = item.location.lat\n        this.longitude = item.location.lng\n        this.saveStartPlace(item.address)\n        this.saveFormattedStartPlace(item.title)\n        this.saveStartPosition([this.latitude, this.longitude])\n        this.goBack()\n        this.$refs.searchBar.clear()\n      },\n      cancel(){\n        wx.navigateBack()\n        this.clearData()\n      },\n      clearData(){\n        this.addresses = []\n        this.$refs.searchBar.clear()\n      },\n      onclickLocation(e){\n        this.mapCtx.moveToLocation()\n      },\n      regionChange(){\n        console.log('regionChange', e)\n\n      },\n      begin({timeStamp}){\n        touchTimeStamp = timeStamp\n      },\n      end({timeStamp}){\n        console.log('end')\n//       加入时间判断\n//       解决修改data内数据导致地图在拖动开始时闪回原位的bug\n        if (timeStamp - touchTimeStamp > 50) {\n          this.mapCtx.getCenterLocation({\n            success: (res) => {\n              reverseGeocoder(qqmapsdk, res).then(res => {\n                this.saveStartPlace(res.result.address)\n                this.saveFormattedStartPlace(res.result.formatted_addresses.recommend)\n              })\n              const lon_distance = res.longitude - this.longitude\n              const lat_distance = res.latitude - this.latitude\n              // 更新当前位置坐标\n              this.longitude = res.longitude\n              this.latitude = res.latitude\n              //判断屏幕移动的距离，如果超过阀值\n              if (Math.abs(lon_distance) >= 0.0022 || Math.abs(lat_distance) >= 0.0022) {\n                //刷新附近的车\n                this.updateCars()\n                //刷新等待时间\n                this.minutes = getRandomNum(3, 12)\n              }\n            }\n          })\n        }\n      },\n      updateCars(){\n        this.markers = []\n        const carNum = getRandomNum(3, 8)\n        for (let i = 1; i <= carNum; i++) {\n          // 定义一个车对象\n          let car = {\n            id: 0,\n            iconPath: \"/static/img/car/cart1.png\",\n            latitude: 0,\n            longitude: 0,\n            width: 35,\n            height: 15\n          }\n\n          //随机值\n          const lon_dis = (Math.ceil(Math.random() * 99)) * 0.00012;\n          const lat_dis = (Math.ceil(Math.random() * 99)) * 0.00012;\n\n          car.id = 2 + i\n          car.latitude = this.latitude + lat_dis\n          car.longitude = this.longitude + lon_dis\n          car.iconPath = `/static/img/car/cart${this.curNavIndex + 1}.png`\n          this.markers.push(car)\n        }\n      },\n      setStartPlace(){\n        //这里只需要再保存位置就好了\n        this.saveStartPosition([this.latitude, this.longitude])\n        wx.redirectTo({\n          url: \"/pages/index/index\",\n        })\n      },\n      ...mapMutations({\n        saveStartPlace: 'SET_START_PLACE',\n        saveFormattedStartPlace: 'SET_FORMATTED_START_PLACE',\n        saveCurCity: 'SET_CUR_CITY',\n        saveStartPosition: 'SET_START_POSITION'\n      })\n    },\n    computed: {\n      ...mapState([\n        'curNavIndex',\n        'curCity',\n        'startPlace',\n        'startFormattedPlace',\n        'startPosition'\n      ])\n    },\n    components: {\n      SearchBar,\n      AddressList\n    }\n  }\n</script>\n\n<style lang=\"less\" scoped rel=\"stylesheet/less\">\n  @import '../../common/less/mixin1';\n\n  .starting-page {\n    width: 100%;\n    height: 100vh;\n    overflow: hidden;\n    .search-bar-wrapper {\n      width: 100%;\n      height: 44px;\n      .card-shadow(#e0e0e0)\n    }\n    /*.address-list-wrapper {*/\n    /*position: fixed;*/\n    /*top: 45px;*/\n    /*left: 0;*/\n    /*right: 0;*/\n    /*height: 300px;*/\n    /*width: 100%;*/\n    /*z-index: 999;*/\n    /*background-color: #fff;*/\n    /*}*/\n    .map-didi {\n      width: 100%;\n      height: calc(100% - 44px);\n      .location-marker {\n        position: fixed;\n        left: 12px;\n        bottom: 95px;\n        width: 32px;\n        height: 32px;\n      }\n      .center-marker {\n        position: fixed;\n        left: 50%;\n        top: calc(50% - 47px);\n        transform: translateX(-50%);\n        width: 110px;\n        height: 70px;\n        text-align: center;\n        .text-center {\n          padding: 0 4px;\n          position: relative;\n          height: 25px;\n          line-height: 25px;\n          color: #f5f5f5;\n          background-color: #616161;\n          font-size: 12px;\n          border-radius: 12px;\n          box-sizing: border-box;\n        }\n        .inverted-triangle {\n          position: absolute;\n          left: 45px;\n          top: 16px;\n          width: 20px;\n          height: 20px;\n        }\n        .img-center {\n          display: inline-block;\n          margin-top: 8px;\n          width: 38px;\n          height: 40px;\n        }\n      }\n      .address {\n        display: flex;\n        align-items: center;\n        position: absolute;\n        bottom: 20px;\n        left: 12px;\n        right: 12px;\n        height: 60px;\n        box-sizing: border-box;\n        overflow: hidden;\n        background-color: #fff;\n        .img-address {\n          padding-left: 4px;\n          flex: 0 0 40px;\n          width: 40px;\n          height: 40px;\n        }\n        .address-desc {\n          margin-left: 5px;\n          flex: 1;\n          height: 40px;\n          .blur {\n            font-size: 14px;\n            color: #333333;\n            .no-wrap();\n          }\n          .detail {\n            padding-top: 6px;\n            .no-wrap();\n            font-size: 12px;\n            color: #c7c7c7;\n          }\n        }\n        .btn-address {\n          padding: 20px;\n          letter-spacing: 4px;\n          flex: 0 0 40px;\n          text-align: center;\n          font-size: 18px;\n          color: #333;\n        }\n      }\n    }\n  }\n</style>\n","import mod from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--10-oneOf-1-2!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-3!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-4!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--10-oneOf-1-5!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=style&index=0&id=dc547508&lang=less&scoped=true&rel=stylesheet%2Fless&\"; export default mod; export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--10-oneOf-1-2!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-3!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-4!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--10-oneOf-1-5!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=style&index=0&id=dc547508&lang=less&scoped=true&rel=stylesheet%2Fless&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1617546235104\n      var cssReload = require(\"/Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}